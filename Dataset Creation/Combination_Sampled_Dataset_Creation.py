# -*- coding: utf-8 -*-
"""Combination Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ytKEuXIpXT57r32pgD-icK85H4czfcVY
"""

pip install datasets

import pandas as pd
from datasets import Dataset

"""-----------------------------------"""

beverage_file = '/content/drive/MyDrive/Data Mining Project/Entities/beverage.xlsx'
beverage_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Beverage_Train.xlsx'

beverages = pd.read_excel(beverage_file)
beverage_train_prompts = pd.read_excel(beverage_train_file)
print(beverages.shape)

authors_file = '/content/drive/MyDrive/Data Mining Project/Entities/authors.xlsx'
authors_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Authors_Train.xlsx'

authors = pd.read_excel(authors_file)
authors_train_prompts = pd.read_excel(authors_train_file)
print(authors.shape)

clothing_female_file = '/content/drive/MyDrive/Data Mining Project/Entities/clothing-female.xlsx'
clothing_female_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Clothing-Female_Train.xlsx'

clothing_female = pd.read_excel(clothing_female_file)
clothing_female_train_prompts = pd.read_excel(clothing_female_train_file)
print(clothing_female.shape)

clothing_male_file = '/content/drive/MyDrive/Data Mining Project/Entities/clothing-male.xlsx'
clothing_male_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Clothing-Male_Train.xlsx'

clothing_male = pd.read_excel(clothing_male_file)
clothing_male_train_prompts = pd.read_excel(clothing_male_train_file)
print(clothing_male.shape)

food_file = '/content/drive/MyDrive/Data Mining Project/Entities/food.xlsx'
food_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Food_Train.xlsx'

food = pd.read_excel(food_file)
food_train_prompts = pd.read_excel(food_train_file)
print(food.shape)

locations_file = '/content/drive/MyDrive/Data Mining Project/Entities/new_locations.xlsx'
locations_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Location_Train.xlsx'

locations = pd.read_excel(locations_file)
locations_train_prompts = pd.read_excel(locations_train_file)
print(locations.shape)

names_female_file = '/content/drive/MyDrive/Data Mining Project/Entities/names-female.xlsx'
names_female_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Names-Female_Train.xlsx'

names_female = pd.read_excel(names_female_file)
names_female_train_prompts = pd.read_excel(names_female_train_file)
print(names_female.shape)

names_male_file = '/content/drive/MyDrive/Data Mining Project/Entities/names-male.xlsx'
names_male_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Names-Male_Train.xlsx'

names_male = pd.read_excel(names_male_file)
names_male_train_prompts = pd.read_excel(names_male_train_file)
print(names_male.shape)

religious_places_file = '/content/drive/MyDrive/Data Mining Project/Entities/religious-places.xlsx'
religious_places_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Religion_Train.xlsx'

religious_places = pd.read_excel(religious_places_file)
religious_places_train_prompts = pd.read_excel(religious_places_train_file)
print(religious_places.shape)

sports_clubs_file = '/content/drive/MyDrive/Data Mining Project/Entities/sports-clubs.xlsx'
sports_clubs_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Sports_Train.xlsx'

sports_clubs = pd.read_excel(sports_clubs_file)
sports_clubs_train_prompts = pd.read_excel(sports_clubs_train_file)
print(sports_clubs.shape)

"""---------------------------------"""

import random

def process_entities(entities, max_count=50):
    if len(entities) > max_count:
        return random.sample(entities, max_count)
    return entities

"""-------------------------------"""

arab_beverages = beverages[beverages['Culture'] == 'Arab']['Entity'].tolist()
western_beverages = beverages[beverages['Culture'] == 'Western']['Entity'].tolist()
prompts_beverages = beverage_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_beverages))
print("Number of Arab entities: ", len(arab_beverages))
print("Number of Western entites: ", len(western_beverages))

print("-"* 100)
processed_arab_beverages = process_entities(beverages[beverages['Culture'] == 'Arab']['Entity'].tolist())
processed_western_beverages = process_entities(beverages[beverages['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Beverages:", len(processed_arab_beverages))
print("Processed Western Beverages:", len(processed_western_beverages))

print("-"*100)
print("Total number of combinations: ", len(processed_arab_beverages) *len(processed_western_beverages) * len(prompts_beverages))

arab_authors = authors[authors['Culture'] == 'Arab']['Entity'].tolist()
western_authors = authors[authors['Culture'] == 'Western']['Entity'].tolist()
prompts_authors = authors_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_authors))
print("Number of Arab entities: ", len(arab_authors))
print("Number of Western entites: ", len(western_authors))

print("-"* 100)
processed_arab_authors = process_entities(authors[authors['Culture'] == 'Arab']['Entity'].tolist())
processed_western_authors = process_entities(authors[authors['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Authors:", len(processed_arab_authors))
print("Processed Western Authors:", len(processed_western_authors))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_authors) * len(processed_western_authors) * len(prompts_authors))

arab_clothing_female = clothing_female[clothing_female['Culture'] == 'Arab']['Entity'].tolist()
western_clothing_female = clothing_female[clothing_female['Culture'] == 'Western']['Entity'].tolist()
prompts_clothing_female = clothing_female_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_clothing_female))
print("Number of Arab entities: ", len(arab_clothing_female))
print("Number of Western entites: ", len(western_clothing_female))

print("-"* 100)
processed_arab_clothing_female = process_entities(clothing_female[clothing_female['Culture'] == 'Arab']['Entity'].tolist())
processed_western_clothing_female = process_entities(clothing_female[clothing_female['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Clothing Female:", len(processed_arab_clothing_female))
print("Processed Western Clothing Female:", len(processed_western_clothing_female))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_clothing_female) * len(processed_western_clothing_female) * len(prompts_clothing_female))

arab_clothing_male = clothing_male[clothing_male['Culture'] == 'Arab']['Entity'].tolist()
western_clothing_male = clothing_male[clothing_male['Culture'] == 'Western']['Entity'].tolist()
prompts_clothing_male = clothing_male_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_clothing_male))
print("Number of Arab entities: ", len(arab_clothing_male))
print("Number of Western entites: ", len(western_clothing_male))

print("-"* 100)
processed_arab_clothing_male = process_entities(clothing_male[clothing_male['Culture'] == 'Arab']['Entity'].tolist())
processed_western_clothing_male = process_entities(clothing_male[clothing_male['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Clothing Male:", len(processed_arab_clothing_male))
print("Processed Western Clothing Male:", len(processed_western_clothing_male))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_clothing_male) * len(processed_western_clothing_male) * len(prompts_clothing_male))

arab_food = food[food['Culture'] == 'Arab']['Entity'].tolist()
western_food = food[food['Culture'] == 'Western']['Entity'].tolist()
prompts_food = food_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_food))
print("Number of Arab entities: ", len(arab_food))
print("Number of Western entites: ", len(western_food))

print("-"* 100)
processed_arab_food = process_entities(food[food['Culture'] == 'Arab']['Entity'].tolist())
processed_western_food = process_entities(food[food['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Food:", len(processed_arab_food))
print("Processed Western Food:", len(processed_western_food))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_food) * len(processed_western_food) * len(prompts_food))

arab_locations = locations[locations['Culture'] == 'Arab']['Entity'].tolist()
western_locations = locations[locations['Culture'] == 'Western']['Entity'].tolist()
prompts_locations = locations_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_locations))
print("Number of Arab entities: ", len(arab_locations))
print("Number of Western entites: ", len(western_locations))

print("-"* 100)
processed_arab_locations = process_entities(locations[locations['Culture'] == 'Arab']['Entity'].tolist())
processed_western_locations = process_entities(locations[locations['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Locations:", len(processed_arab_locations))
print("Processed Western Locations:", len(processed_western_locations))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_locations) * len(processed_western_locations) * len(prompts_locations))

arab_names_female = names_female[names_female['Culture'] == 'Arab']['Entity'].tolist()
western_names_female = names_female[names_female['Culture'] == 'Western']['Entity'].tolist()
prompts_names_female = names_female_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_names_female))
print("Number of Arab entities: ", len(arab_names_female))
print("Number of Western entites: ", len(western_names_female))

print("-"* 100)
processed_arab_names_female = process_entities(names_female[names_female['Culture'] == 'Arab']['Entity'].tolist())
processed_western_names_female = process_entities(names_female[names_female['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Names Female:", len(processed_arab_names_female))
print("Processed Western Names Female:", len(processed_western_names_female))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_names_female) * len(processed_western_names_female) * len(prompts_names_female))

arab_names_male = names_male[names_male['Culture'] == 'Arab']['Entity'].tolist()
western_names_male = names_male[names_male['Culture'] == 'Western']['Entity'].tolist()
prompts_names_male = names_male_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_names_male))
print("Number of Arab entities: ", len(arab_names_male))
print("Number of Western entites: ", len(western_names_male))

print("-"* 100)
processed_arab_names_male = process_entities(names_male[names_male['Culture'] == 'Arab']['Entity'].tolist())
processed_western_names_male = process_entities(names_male[names_male['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Names Male:", len(processed_arab_names_male))
print("Processed Western Names Male:", len(processed_western_names_male))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_names_male) * len(processed_western_names_male) * len(prompts_names_male))

arab_religious_places = religious_places[religious_places['Culture'] == 'Arab']['Entity'].tolist()
western_religious_places = religious_places[religious_places['Culture'] == 'Western']['Entity'].tolist()
prompts_religious_places = religious_places_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_religious_places))
print("Number of Arab entities: ", len(arab_religious_places))
print("Number of Western entites: ", len(western_religious_places))

print("-"* 100)
processed_arab_religious_places = process_entities(religious_places[religious_places['Culture'] == 'Arab']['Entity'].tolist())
processed_western_religious_places = process_entities(religious_places[religious_places['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Religious Places:", len(processed_arab_religious_places))
print("Processed Western Religious Places:", len(processed_western_religious_places))

print("-" * 100)
print("Total number of combinations: ", len(processed_arab_religious_places) * len(processed_western_religious_places) * len(prompts_religious_places))

arab_sports_clubs = sports_clubs[sports_clubs['Culture'] == 'Arab']['Entity'].tolist()
western_sports_clubs = sports_clubs[sports_clubs['Culture'] == 'Western']['Entity'].tolist()
prompts_sports_clubs = sports_clubs_train_prompts['Prompt'].tolist()
print("Number of prompts: ", len(prompts_sports_clubs))
print("Number of Arab entities: ", len(arab_sports_clubs))
print("Number of Western entites: ", len(western_sports_clubs))

print("-"* 100)
processed_arab_sports_clubs = process_entities(sports_clubs[sports_clubs['Culture'] == 'Arab']['Entity'].tolist())
processed_western_sports_clubs = process_entities(sports_clubs[sports_clubs['Culture'] == 'Western']['Entity'].tolist())
print("Processed Arab Sports Clubs:", len(processed_arab_sports_clubs))
print("Processed Western Sports Clubs:", len(processed_western_sports_clubs))


print("-" * 100)
print("Total number of combinations: ", len(processed_arab_sports_clubs) * len(processed_western_sports_clubs) * len(prompts_sports_clubs))

"""--------------------------------------"""

def create_dataset(prompts, arab_entities, western_entities):
    dataset_dict = {
        "Prompt": [],
        "Arab": [],
        "Western": []
    }
    # Generate all combinations
    for prompt in prompts:
        for arab in arab_entities:
            for western in western_entities:
                dataset_dict["Prompt"].append(prompt)
                dataset_dict["Arab"].append(arab)
                dataset_dict["Western"].append(western)
    return Dataset.from_dict(dataset_dict)

# Beverages
dataset_beverages = create_dataset(prompts_beverages, processed_arab_beverages, processed_western_beverages)

# Authors
dataset_authors = create_dataset(prompts_authors, processed_arab_authors, processed_western_authors)

# Female Clothing
dataset_clothing_female = create_dataset(prompts_clothing_female, processed_arab_clothing_female, processed_western_clothing_female)

# Male Clothing
dataset_clothing_male = create_dataset(prompts_clothing_male, processed_arab_clothing_male, processed_western_clothing_male)

# Food
dataset_food = create_dataset(prompts_food, processed_arab_food, processed_western_food)

# Locations
dataset_locations = create_dataset(prompts_locations, processed_arab_locations, processed_western_locations)

# Female Names
dataset_names_female = create_dataset(prompts_names_female, processed_arab_names_female, processed_western_names_female)

# Male Names
dataset_names_male = create_dataset(prompts_names_male, processed_arab_names_male, processed_western_names_male)

# Religious Places
dataset_religious_places = create_dataset(prompts_religious_places, processed_arab_religious_places, processed_western_religious_places)

# Sports Clubs
dataset_sports_clubs = create_dataset(prompts_sports_clubs, processed_arab_sports_clubs, processed_western_sports_clubs)

combined_dataset_dict = {
    "Prompt": [],
    "Arab": [],
    "Western": []
}

all_datasets = [
    dataset_beverages,
    dataset_authors,
    dataset_clothing_female,
    dataset_clothing_male,
    dataset_food,
    dataset_locations,
    dataset_names_female,
    dataset_names_male,
    dataset_religious_places,
    dataset_sports_clubs,
]

for dataset in all_datasets:
    combined_dataset_dict["Prompt"].extend(dataset["Prompt"])
    combined_dataset_dict["Arab"].extend(dataset["Arab"])
    combined_dataset_dict["Western"].extend(dataset["Western"])

combined_df = pd.DataFrame(combined_dataset_dict)

output_file_path = '/content/drive/MyDrive/Data Mining Project/combination_sampled_dataset.csv'
combined_df.to_csv(output_file_path, index=False)

dataset = pd.read_csv('/content/drive/MyDrive/Data Mining Project/combination_sampled_dataset.csv')

dataset.shape

