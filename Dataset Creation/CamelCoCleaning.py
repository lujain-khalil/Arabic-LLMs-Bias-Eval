# -*- coding: utf-8 -*-
"""CamelCoCleaning.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1zwNqD1yUxI-L9fQiDiCbVzdJUNvOsq_Z
"""

import pandas as pd

file_path = "/content/drive/MyDrive/Data Mining Project/camelco-prompts-causal-lm.xlsx"
df = pd.read_excel(file_path)

df

df['Prompt'] = df['Prompt'].str.replace('[MASK]', '', regex=False)

output_file_path = '/content/drive/MyDrive/Data Mining Project/cleaned_camelco_prompts.xlsx'
df.to_excel(output_file_path, index=False)

import os
from sklearn.model_selection import train_test_split

df = pd.read_excel(output_file_path)

train_folder = '/content/drive/MyDrive/Data Mining Project/Train'
test_folder = '/content/drive/MyDrive/Data Mining Project/Test'
os.makedirs(train_folder, exist_ok=True)
os.makedirs(test_folder, exist_ok=True)

for entity_type, group in df.groupby('Entity Type'):
    train, test = train_test_split(group, test_size=0.3, random_state=42, shuffle=True)
    train_file = os.path.join(train_folder, f"{entity_type}_Train.xlsx")
    test_file = os.path.join(test_folder, f"{entity_type}_Test.xlsx")
    train.to_excel(train_file, index=False)
    test.to_excel(test_file, index=False)
    print(f"Saved: {train_file} and {test_file}")

