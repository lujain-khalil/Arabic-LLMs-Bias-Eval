# -*- coding: utf-8 -*-
"""DatasetCreation.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/169vVZj0hUwHW1GS7b0uVh97C9LH_oLDs
"""

pip install datasets

import pandas as pd
from datasets import Dataset

# file_path = '/content/drive/MyDrive/Data Mining Project/Entities/new_locations.xlsx'
# df = pd.read_excel(file_path)

# western_df = df[df['Culture'] == 'Western']

# western_retain = western_df.sample(frac=0.33, random_state=42)

# non_western_df = df[df['Culture'] != 'Western']

# final_df = pd.concat([western_retain, non_western_df])

# final_df.to_excel('/content/drive/MyDrive/Data Mining Project/Entities/new_locations.xlsx', index=False)

"""-----------------------------------"""

beverage_file = '/content/drive/MyDrive/Data Mining Project/Entities/beverage.xlsx'
beverage_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Beverage_Train.xlsx'

beverages = pd.read_excel(beverage_file)
beverage_train_prompts = pd.read_excel(beverage_train_file)

authors_file = '/content/drive/MyDrive/Data Mining Project/Entities/authors.xlsx'
authors_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Authors_Train.xlsx'

authors = pd.read_excel(authors_file)
authors_train_prompts = pd.read_excel(authors_train_file)

clothing_female_file = '/content/drive/MyDrive/Data Mining Project/Entities/clothing-female.xlsx'
clothing_female_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Clothing-Female_Train.xlsx'

clothing_female = pd.read_excel(clothing_female_file)
clothing_female_train_prompts = pd.read_excel(clothing_female_train_file)

clothing_male_file = '/content/drive/MyDrive/Data Mining Project/Entities/clothing-male.xlsx'
clothing_male_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Clothing-Male_Train.xlsx'

clothing_male = pd.read_excel(clothing_male_file)
clothing_male_train_prompts = pd.read_excel(clothing_male_train_file)

food_file = '/content/drive/MyDrive/Data Mining Project/Entities/food.xlsx'
food_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Food_Train.xlsx'

food = pd.read_excel(food_file)
food_train_prompts = pd.read_excel(food_train_file)

locations_file = '/content/drive/MyDrive/Data Mining Project/Entities/new_locations.xlsx'
locations_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Location_Train.xlsx'

locations = pd.read_excel(locations_file)
locations_train_prompts = pd.read_excel(locations_train_file)

names_female_file = '/content/drive/MyDrive/Data Mining Project/Entities/names-female.xlsx'
names_female_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Names-Female_Train.xlsx'

names_female = pd.read_excel(names_female_file)
names_female_train_prompts = pd.read_excel(names_female_train_file)

names_male_file = '/content/drive/MyDrive/Data Mining Project/Entities/names-male.xlsx'
names_male_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Names-Male_Train.xlsx'

names_male = pd.read_excel(names_male_file)
names_male_train_prompts = pd.read_excel(names_male_train_file)

religious_places_file = '/content/drive/MyDrive/Data Mining Project/Entities/religious-places.xlsx'
religious_places_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Religion_Train.xlsx'

religious_places = pd.read_excel(religious_places_file)
religious_places_train_prompts = pd.read_excel(religious_places_train_file)

sports_clubs_file = '/content/drive/MyDrive/Data Mining Project/Entities/sports-clubs.xlsx'
sports_clubs_train_file = '/content/drive/MyDrive/Data Mining Project/Train/Sports_Train.xlsx'

sports_clubs = pd.read_excel(sports_clubs_file)
sports_clubs_train_prompts = pd.read_excel(sports_clubs_train_file)

"""---------------------------------"""

arab_beverages = beverages[beverages['Culture'] == 'Arab']['Entity'].tolist()
western_beverages = beverages[beverages['Culture'] == 'Western']['Entity'].tolist()
prompts_beverages = beverage_train_prompts['Prompt'].tolist()
print(len(prompts_beverages))

arab_authors = authors[authors['Culture'] == 'Arab']['Entity'].tolist()
western_authors = authors[authors['Culture'] == 'Western']['Entity'].tolist()
prompts_authors = authors_train_prompts['Prompt'].tolist()
print(len(prompts_authors))

arab_clothing_female = clothing_female[clothing_female['Culture'] == 'Arab']['Entity'].tolist()
western_clothing_female = clothing_female[clothing_female['Culture'] == 'Western']['Entity'].tolist()
prompts_clothing_female = clothing_female_train_prompts['Prompt'].tolist()
print(len(prompts_clothing_female))

arab_clothing_male = clothing_male[clothing_male['Culture'] == 'Arab']['Entity'].tolist()
western_clothing_male = clothing_male[clothing_male['Culture'] == 'Western']['Entity'].tolist()
prompts_clothing_male = clothing_male_train_prompts['Prompt'].tolist()
print(len(prompts_clothing_male))

arab_food = food[food['Culture'] == 'Arab']['Entity'].tolist()
western_food = food[food['Culture'] == 'Western']['Entity'].tolist()
prompts_food = food_train_prompts['Prompt'].tolist()
print(len(prompts_food))

arab_locations = locations[locations['Culture'] == 'Arab']['Entity'].tolist()
western_locations = locations[locations['Culture'] == 'Western']['Entity'].tolist()
prompts_locations = locations_train_prompts['Prompt'].tolist()
print(len(prompts_locations))

arab_names_female = names_female[names_female['Culture'] == 'Arab']['Entity'].tolist()
western_names_female = names_female[names_female['Culture'] == 'Western']['Entity'].tolist()
prompts_names_female = names_female_train_prompts['Prompt'].tolist()
print(len(prompts_names_female))

arab_names_male = names_male[names_male['Culture'] == 'Arab']['Entity'].tolist()
western_names_male = names_male[names_male['Culture'] == 'Western']['Entity'].tolist()
prompts_names_male = names_male_train_prompts['Prompt'].tolist()
print(len(prompts_names_male))

arab_religious_places = religious_places[religious_places['Culture'] == 'Arab']['Entity'].tolist()
western_religious_places = religious_places[religious_places['Culture'] == 'Western']['Entity'].tolist()
prompts_religious_places = religious_places_train_prompts['Prompt'].tolist()
print(len(prompts_religious_places))

arab_sports_clubs = sports_clubs[sports_clubs['Culture'] == 'Arab']['Entity'].tolist()
western_sports_clubs = sports_clubs[sports_clubs['Culture'] == 'Western']['Entity'].tolist()
prompts_sports_clubs = sports_clubs_train_prompts['Prompt'].tolist()
print(len(prompts_sports_clubs))

"""--------------------------------------"""

dataset_dict_beverages = {
    "prompt": prompts_beverages,
    "chosen": [arab_beverages] * len(prompts_beverages),
    "rejected": [western_beverages] * len(prompts_beverages),
}

dataset_dict_food = {
    "prompt": prompts_food,
    "chosen": [arab_food] * len(prompts_food),
    "rejected": [western_food] * len(prompts_food),
}

dataset_dict_authors = {
    "prompt": prompts_authors,
    "chosen": [arab_authors] * len(prompts_authors),
    "rejected": [western_authors] * len(prompts_authors),
}

dataset_dict_sports_clubs = {
    "prompt": prompts_sports_clubs,
    "chosen": [arab_sports_clubs] * len(prompts_sports_clubs),
    "rejected": [western_sports_clubs] * len(prompts_sports_clubs),
}

dataset_dict_religious_places = {
    "prompt": prompts_religious_places,
    "chosen": [arab_religious_places] * len(prompts_religious_places),
    "rejected": [western_religious_places] * len(prompts_religious_places),
}

dataset_dict_clothing_male = {
    "prompt": prompts_clothing_male,
    "chosen": [arab_clothing_male] * len(prompts_clothing_male),
    "rejected": [western_clothing_male] * len(prompts_clothing_male),
}

dataset_dict_clothing_female = {
    "prompt": prompts_clothing_female,
    "chosen": [arab_clothing_female] * len(prompts_clothing_female),
    "rejected": [western_clothing_female] * len(prompts_clothing_female),
}

dataset_dict_names_male = {
    "prompt": prompts_names_male,
    "chosen": [arab_names_male] * len(prompts_names_male),
    "rejected": [western_names_male] * len(prompts_names_male),
}

dataset_dict_names_female = {
    "prompt": prompts_names_female,
    "chosen": [arab_names_female] * len(prompts_names_female),
    "rejected": [western_names_female] * len(prompts_names_female),
}

dataset_dict_locations = {
    "prompt": prompts_locations,
    "chosen": [arab_locations] * len(prompts_locations),
    "rejected": [western_locations] * len(prompts_locations),
}

all_dictionaries = [dataset_dict_locations, dataset_dict_names_female, dataset_dict_names_male, dataset_dict_clothing_female, dataset_dict_clothing_male, dataset_dict_religious_places, dataset_dict_sports_clubs, dataset_dict_authors, dataset_dict_beverages, dataset_dict_food]

combined_dict = {"prompt": [], "chosen": [], "rejected": []}

for single_dict in all_dictionaries:
    combined_dict["prompt"].extend(single_dict["prompt"])
    combined_dict["chosen"].extend(single_dict["chosen"])
    combined_dict["rejected"].extend(single_dict["rejected"])

df = pd.DataFrame(combined_dict)

output_file_path = '/content/drive/MyDrive/Data Mining Project/combined_dataset.csv'
df.to_csv(output_file_path, index=False)

print(f"CSV file saved at: {output_file_path}")

